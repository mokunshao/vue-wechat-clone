(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-89f5da50"],{"00b3":function(t,e,n){"use strict";var r=n("4427"),a=n.n(r);a.a},"0418":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("header",{staticClass:"header"},[t.hasLeft?n("div",{staticClass:"headerButton"},[n("font-awesome-icon",{attrs:{icon:"chevron-left"}}),n("button",{on:{click:t.goBack}},[t._v("返回")])],1):t._e(),n("div",{staticClass:"headerTitle"},[t._v(t._s(t.title))]),t.btnIcon?n("div",{staticClass:"headerButton"},[n("button",{on:{click:function(e){return t.$emit("clickRight")}}},[n("font-awesome-icon",{attrs:{icon:t.btnIcon}})],1)]):t._e()])},a=[],s={name:"Header",props:{title:String,hasLeft:{type:Boolean,default:!1},btnIcon:String,goBackTo:String},methods:{goBack:function(){this.goBackTo?this.$router.push(this.goBackTo):this.$router.go(-1)}}},o=s,c=(n("00b3"),n("2877")),i=Object(c["a"])(o,r,a,!1,null,"26b70ee1",null);e["a"]=i.exports},"11e9":function(t,e,n){var r=n("52a7"),a=n("4630"),s=n("6821"),o=n("6a99"),c=n("69a8"),i=n("c69a"),u=Object.getOwnPropertyDescriptor;e.f=n("9e1e")?u:function(t,e){if(t=s(t),e=o(e,!0),i)try{return u(t,e)}catch(n){}if(c(t,e))return a(!r.f.call(t,e),t[e])}},"24a1":function(t,e,n){},"405a":function(t,e,n){"use strict";var r=n("24a1"),a=n.n(r);a.a},4427:function(t,e,n){},"5dbc":function(t,e,n){var r=n("d3f4"),a=n("8b97").set;t.exports=function(t,e,n){var s,o=e.constructor;return o!==n&&"function"==typeof o&&(s=o.prototype)!==n.prototype&&r(s)&&a&&a(t,s),t}},"6c23":function(t,e,n){"use strict";e["a"]={ws:null,init:function(t,e,n){var r=this;this.ws||(this.ws=new WebSocket("ws://localhost:3000/".concat(t.user.id))),this.ws.onmessage=function(t){var n=JSON.parse(t.data);e&&e(n)},this.ws.onerror=function(t){n&&n(t)},this.ws.onclose=function(){r.ws=null}},send:function(t){this.ws.send(JSON.stringify(t))}}},"8b97":function(t,e,n){var r=n("d3f4"),a=n("cb7c"),s=function(t,e){if(a(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{r=n("9b43")(Function.call,n("11e9").f(Object.prototype,"__proto__").set,2),r(t,[]),e=!(t instanceof Array)}catch(a){e=!0}return function(t,n){return s(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:s}},9093:function(t,e,n){var r=n("ce10"),a=n("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,a)}},aa77:function(t,e,n){var r=n("5ca1"),a=n("be13"),s=n("79e5"),o=n("fdef"),c="["+o+"]",i="​",u=RegExp("^"+c+c+"*"),f=RegExp(c+c+"*$"),l=function(t,e,n){var a={},c=s(function(){return!!o[t]()||i[t]()!=i}),u=a[t]=c?e(h):o[t];n&&(a[n]=u),r(r.P+r.F*c,"String",a)},h=l.trim=function(t,e){return t=String(a(t)),1&e&&(t=t.replace(u,"")),2&e&&(t=t.replace(f,"")),t};t.exports=l},bb51:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[n("Header",{attrs:{title:"微信",btnIcon:"plus"}}),n("div",{staticClass:"container"},t._l(t.chatDataList,function(e){return n("UserCell",{key:e._id,attrs:{user:e.target,count:e.count},on:{click:function(n){return t.$router.push({name:"Chat",params:{user:e.target}})}}})}),1)],1)},a=[],s=n("0418"),o=n("d37e"),c=n("6c23"),i={name:"Home",data:function(){return{chatDataList:[]}},computed:{user:function(){return this.$store.getters.user}},mounted:function(){var t=this;c["a"].init({user:this.user},function(e){t.setMessageCount(e)},function(t){console.log(t)})},methods:{setMessageCount:function(t){var e=this.chatDataList.filter(function(e){return e.target._id===t.from});e.length>0?(e[0].count++,e[0].message.push({msg:t.msg,source:"other"}),this.saveMsg(e[0].target,e[0].count,e[0].message)):this.getUserInfo(t)},getUserInfo:function(t){var e=this;this.$axios("/api/user/".concat(t.from)).then(function(n){var r=[];r.push({msg:t.msg,source:"other"}),e.chatDataList.push({target:n.data,count:1,message:r}),e.saveMsg(n.data,1,r)})},saveMsg:function(t,e,n){var r={target:{avatar:t.avatar,username:t.username,_id:t._id},count:e,message:n,user_id:this.user.id};this.$axios.post("/api/chat/addmsg",r).then(function(){console.log("数据保存成功")})}},beforeRouteEnter:function(t,e,n){n(function(t){t.$axios.get("/api/chat/msg/".concat(t.user.id)).then(function(e){t.chatDataList=e.data})})},components:{Header:s["a"],UserCell:o["a"]}},u=i,f=(n("db72"),n("2877")),l=Object(f["a"])(u,r,a,!1,null,"254e3745",null);e["default"]=l.exports},c5f6:function(t,e,n){"use strict";var r=n("7726"),a=n("69a8"),s=n("2d95"),o=n("5dbc"),c=n("6a99"),i=n("79e5"),u=n("9093").f,f=n("11e9").f,l=n("86cc").f,h=n("aa77").trim,p="Number",d=r[p],g=d,v=d.prototype,m=s(n("2aeb")(v))==p,_="trim"in String.prototype,b=function(t){var e=c(t,!1);if("string"==typeof e&&e.length>2){e=_?e.trim():h(e,3);var n,r,a,s=e.charCodeAt(0);if(43===s||45===s){if(n=e.charCodeAt(2),88===n||120===n)return NaN}else if(48===s){switch(e.charCodeAt(1)){case 66:case 98:r=2,a=49;break;case 79:case 111:r=8,a=55;break;default:return+e}for(var o,i=e.slice(2),u=0,f=i.length;u<f;u++)if(o=i.charCodeAt(u),o<48||o>a)return NaN;return parseInt(i,r)}}return+e};if(!d(" 0o1")||!d("0b1")||d("+0x1")){d=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof d&&(m?i(function(){v.valueOf.call(n)}):s(n)!=p)?o(new g(b(e)),n,d):b(e)};for(var w,I=n("9e1e")?u(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),N=0;I.length>N;N++)a(g,w=I[N])&&!a(d,w)&&l(d,w,f(g,w));d.prototype=v,v.constructor=d,n("2aba")(r,p,d)}},d37e:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"cellWrapper",on:{click:function(e){return t.$emit("click")}}},[n("div",{staticClass:"cellTitle"},[n("img",{attrs:{src:t.user.avatar,alt:"avatar"}}),n("span",{directives:[{name:"show",rawName:"v-show",value:t.count,expression:"count"}],staticClass:"badge"},[t._v(t._s(t.count))]),n("span",[t._v(t._s(t.user.username))])])])},a=[],s=(n("c5f6"),{name:"UserCell",props:{user:Object,count:Number}}),o=s,c=(n("405a"),n("2877")),i=Object(c["a"])(o,r,a,!1,null,"39d75c90",null);e["a"]=i.exports},db72:function(t,e,n){"use strict";var r=n("e0f1"),a=n.n(r);a.a},e0f1:function(t,e,n){},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-89f5da50.d50cec71.js.map