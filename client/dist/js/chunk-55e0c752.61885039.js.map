{"version":3,"sources":["webpack:///./src/components/Header.vue?22d3","webpack:///./src/components/Header.vue?bd55","webpack:///src/components/Header.vue","webpack:///./src/components/Header.vue?4a23","webpack:///./src/components/Header.vue","webpack:///./src/views/Chat.vue?c360","webpack:///./src/views/Chat.vue?204d","webpack:///src/views/Chat.vue","webpack:///./src/views/Chat.vue?880d","webpack:///./src/views/Chat.vue","webpack:///./src/socket.js"],"names":["_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_Header_vue_vue_type_style_index_0_id_26b70ee1_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_Header_vue_vue_type_style_index_0_id_26b70ee1_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","n","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","icon","on","click","goBack","_v","_e","_s","title","$event","$emit","btnIcon","staticRenderFns","Headervue_type_script_lang_js_","name","props","String","hasLeft","type","Boolean","default","goBackTo","methods","$router","push","go","components_Headervue_type_script_lang_js_","component","Object","componentNormalizer","__webpack_exports__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_Chat_vue_vue_type_style_index_0_id_0e033a5c_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_Chat_vue_vue_type_style_index_0_id_0e033a5c_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","targetUser","username","_l","item","index","key","source","src","avatar","alt","msg","user","directives","rawName","value","expression","domProps","input","target","composing","messageValue","disabled","sendMessage","Chatvue_type_script_lang_js_","components","Header","computed","$store","getters","data","messageList","saveMessage","_this","message","_id","count","user_id","id","$axios","post","then","msgObj","current","socket","send","getMessage","_this2","concat","res","result","filter","length","beforeRouteEnter","to","from","next","vm","params","mounted","_this3","init","error","console","log","views_Chatvue_type_script_lang_js_","ws","config","onMessage","onError","WebSocket","onmessage","event","JSON","parse","onerror","onclose","stringify"],"mappings":"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","file":"js/chunk-55e0c752.61885039.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Header.vue?vue&type=style&index=0&id=26b70ee1&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Header.vue?vue&type=style&index=0&id=26b70ee1&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('header',{staticClass:\"header\"},[(_vm.hasLeft)?_c('div',{staticClass:\"headerButton\"},[_c('font-awesome-icon',{attrs:{\"icon\":\"chevron-left\"}}),_c('button',{on:{\"click\":_vm.goBack}},[_vm._v(\"返回\")])],1):_vm._e(),_c('div',{staticClass:\"headerTitle\"},[_vm._v(_vm._s(_vm.title))]),(_vm.btnIcon)?_c('div',{staticClass:\"headerButton\"},[_c('button',{on:{\"click\":function($event){return _vm.$emit('clickRight')}}},[_c('font-awesome-icon',{attrs:{\"icon\":_vm.btnIcon}})],1)]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <header class=\"header\">\r\n    <div class=\"headerButton\" v-if=\"hasLeft\">\r\n      <font-awesome-icon icon=\"chevron-left\"/>\r\n      <button @click=\"goBack\">返回</button>\r\n    </div>\r\n    <div class=\"headerTitle\">{{title}}</div>\r\n    <div class=\"headerButton\" v-if=\"btnIcon\">\r\n      <button @click=\"$emit('clickRight')\">\r\n        <font-awesome-icon :icon=\"btnIcon\"/>\r\n      </button>\r\n    </div>\r\n  </header>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"Header\",\r\n  props: {\r\n    title: String,\r\n    hasLeft: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    btnIcon: String,\r\n    goBackTo: String\r\n  },\r\n  methods: {\r\n    goBack() {\r\n      if (this.goBackTo) {\r\n        this.$router.push(this.goBackTo);\r\n      } else {\r\n        this.$router.go(-1);\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.header {\r\n  display: flex;\r\n  align-items: center;\r\n  background-color: #272626;\r\n  box-sizing: border-box;\r\n  color: #fff;\r\n  font-size: 18px;\r\n  height: 50px;\r\n  line-height: 1;\r\n  padding: 0 10px;\r\n  position: relative;\r\n  text-align: center;\r\n  white-space: nowrap;\r\n  width: 100%;\r\n  z-index: 99;\r\n  .headerButton button {\r\n    background-color: transparent;\r\n    border: 0;\r\n    box-shadow: none;\r\n    color: inherit;\r\n    display: inline-block;\r\n    padding: 0;\r\n    font-size: inherit;\r\n    outline: none;\r\n  }\r\n  .headerTitle {\r\n    flex: 1;\r\n  }\r\n}\r\n</style>\r\n\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Header.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Header.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Header.vue?vue&type=template&id=26b70ee1&scoped=true&\"\nimport script from \"./Header.vue?vue&type=script&lang=js&\"\nexport * from \"./Header.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Header.vue?vue&type=style&index=0&id=26b70ee1&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"26b70ee1\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=style&index=0&id=0e033a5c&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=style&index=0&id=0e033a5c&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.targetUser)?_c('div',{staticClass:\"chat\"},[_c('Header',{attrs:{\"title\":_vm.targetUser.username,\"hasLeft\":true,\"btnIcon\":\"ellipsis-h\"}}),_c('div',{staticClass:\"container\"},_vm._l((_vm.messageList),function(item,index){return _c('div',{key:index,staticClass:\"content_wrap\"},[(item.source === 'other')?_c('div',{staticClass:\"left_msg\"},[_c('img',{attrs:{\"src\":_vm.targetUser.avatar,\"alt\":\"img\"}}),_c('span',[_vm._v(_vm._s(item.msg))])]):_vm._e(),(item.source==='self')?_c('div',{staticClass:\"right_msg\"},[_c('span',[_vm._v(_vm._s(item.msg))]),_c('img',{attrs:{\"src\":_vm.user.avatar,\"alt\":\"img\"}})]):_vm._e()])}),0),_c('div',{staticClass:\"footerWrap\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.messageValue),expression:\"messageValue\"}],attrs:{\"type\":\"text\"},domProps:{\"value\":(_vm.messageValue)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.messageValue=$event.target.value}}}),_c('button',{attrs:{\"disabled\":!_vm.messageValue},on:{\"click\":_vm.sendMessage}},[_vm._v(\"发送\")])])],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"chat\" v-if=\"targetUser\">\r\n    <Header :title=\"targetUser.username\" :hasLeft=\"true\" btnIcon=\"ellipsis-h\"/>\r\n    <div class=\"container\">\r\n      <div class=\"content_wrap\" v-for=\"(item,index) in messageList\" :key=\"index\">\r\n        <div class=\"left_msg\" v-if=\"item.source === 'other'\">\r\n          <img :src=\"targetUser.avatar\" alt=\"img\">\r\n          <span>{{item.msg}}</span>\r\n        </div>\r\n        <div class=\"right_msg\" v-if=\"item.source==='self'\">\r\n          <span>{{item.msg}}</span>\r\n          <img :src=\"user.avatar\" alt=\"img\">\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"footerWrap\">\r\n      <input type=\"text\" v-model=\"messageValue\">\r\n      <button :disabled=\"!messageValue\" @click=\"sendMessage\">发送</button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Header from \"../components/Header\";\r\nimport websocket from \"../socket.js\";\r\n\r\nexport default {\r\n  name: \"Chat\",\r\n  components: {\r\n    Header\r\n  },\r\n  computed: {\r\n    user() {\r\n      return this.$store.getters.user;\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      targetUser: null,\r\n      messageValue: \"\",\r\n      messageList: []\r\n    };\r\n  },\r\n  methods: {\r\n    saveMessage() {\r\n      let message = {\r\n        target: {\r\n          avatar: this.targetUser.avatar,\r\n          username: this.targetUser.username,\r\n          _id: this.targetUser._id\r\n        },\r\n        count: 0,\r\n        message: this.messageList,\r\n        user_id: this.user.id\r\n      };\r\n      this.$axios.post(\"/api/chat/addmsg\", message).then(() => {\r\n        this.messageValue = \"\";\r\n      });\r\n    },\r\n    sendMessage() {\r\n      const msgObj = {\r\n        target: this.targetUser._id,\r\n        current: this.user.id,\r\n        msg: this.messageValue\r\n      };\r\n      websocket.send(msgObj);\r\n      this.messageList.push({\r\n        msg: this.messageValue,\r\n        source: \"self\"\r\n      });\r\n      this.saveMessage();\r\n      this.messageValue = \"\";\r\n    },\r\n    getMessage() {\r\n      this.$axios(`/api/chat/msg/${this.user.id}`).then(res => {\r\n        let result = res.data.filter(data => {\r\n          return data.target._id === this.targetUser._id;\r\n        });\r\n        if (result.length > 0) {\r\n          this.messageList = result[0].message;\r\n        }\r\n      });\r\n    }\r\n  },\r\n  beforeRouteEnter(to, from, next) {\r\n    next(vm => {\r\n      vm.targetUser = to.params.user;\r\n      vm.getMessage();\r\n    });\r\n  },\r\n  mounted() {\r\n    websocket.init(\r\n      { user: this.user },\r\n      message => {\r\n        this.messageList.push({ msg: message.msg, source: \"other\" });\r\n        this.saveMessage();\r\n      },\r\n      error => console.log(error)\r\n    );\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.chat {\r\n  height: 100%;\r\n  .container {\r\n    height: calc(100% - 100px);\r\n    box-sizing: border-box;\r\n    background-color: #f1f1f1;\r\n    padding: 8px;\r\n    overflow-y: scroll;\r\n  }\r\n  .footerWrap {\r\n    width: 100%;\r\n    height: 50px;\r\n    box-sizing: border-box;\r\n    border-top: 1px solid #d9d9d9;\r\n    position: absolute;\r\n    bottom: 0;\r\n    padding: 8px;\r\n    background-color: #fafafa;\r\n    & input {\r\n      width: 77%;\r\n      height: 30px;\r\n      outline: none;\r\n      border: 1px solid #d9d9d9;\r\n      border-radius: 4px;\r\n    }\r\n    & button {\r\n      width: 20%;\r\n      height: 34px;\r\n      border: 1px solid #d9d9d9;\r\n      border-radius: 4px;\r\n      margin-left: 8px;\r\n      outline: none;\r\n      background-color: #f1f1f1;\r\n    }\r\n    & button[disabled] {\r\n      background-color: #d9d9d9;\r\n      cursor: not-allowed;\r\n      pointer-events: none;\r\n    }\r\n  }\r\n}\r\n\r\n.content_wrap {\r\n  .left_msg {\r\n    justify-content: flex-start;\r\n    & span {\r\n      background-color: #fff;\r\n    }\r\n  }\r\n  .right_msg {\r\n    justify-content: flex-end;\r\n    & span {\r\n      background-color: #0fce0d;\r\n    }\r\n  }\r\n  .left_msg,\r\n  .right_msg {\r\n    width: 100%;\r\n    display: flex;\r\n    margin: 5px 0;\r\n  }\r\n  & img {\r\n    width: 3rem;\r\n    height: 3rem;\r\n  }\r\n  & span {\r\n    display: inline-block;\r\n    max-width: 65%;\r\n    border: 1px solid #d9d9d9;\r\n    border-radius: 4px;\r\n    margin: 0 5px;\r\n    padding: 8px;\r\n    box-sizing: border-box;\r\n    word-break: break-all;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Chat.vue?vue&type=template&id=0e033a5c&scoped=true&\"\nimport script from \"./Chat.vue?vue&type=script&lang=js&\"\nexport * from \"./Chat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Chat.vue?vue&type=style&index=0&id=0e033a5c&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0e033a5c\",\n  null\n  \n)\n\nexport default component.exports","export default {\r\n  // 保证整个项目只有一个socket实例\r\n  ws: null, // Websocket实例\r\n  init(config, onMessage, onError) {\r\n    if (!this.ws) {\r\n      // 实例化socket对象\r\n      this.ws = new WebSocket(`ws://localhost:3000/${config.user.id}`);\r\n    }\r\n\r\n    // 客户端接收消息\r\n    this.ws.onmessage = event => {\r\n      let message = JSON.parse(event.data);\r\n      onMessage && onMessage(message); // 接收到消息触发的回调\r\n    };\r\n\r\n    // 出错\r\n    this.ws.onerror = error => {\r\n      onError && onError(error);\r\n    };\r\n\r\n    this.ws.onclose = () => {\r\n      this.ws = null;\r\n    };\r\n  },\r\n  send(msgObj) {\r\n    // 发送消息的时候触发\r\n    this.ws.send(JSON.stringify(msgObj));\r\n  }\r\n};\r\n"],"sourceRoot":""}